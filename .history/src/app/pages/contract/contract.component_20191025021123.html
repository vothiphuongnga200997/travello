<nb-card>
    <div class="containermng border border-crawler ">
        <button type="button" class="btn-pages" (click)="toggle()"><i class="fas fa-filter"></i>Lọc</button>
        <button type="reset" class="btn-pages" (click)="getContract()"><i class="fas fa-sync-alt"></i>Làm mới</button>
        <button type="button" class="btn-pages" (click)="addCustom()"><i class="fas fa-plus"></i>Thêm hợp đồng</button>
        <button type="button" class="btn-pages" (click)="openContractCancel()"><i class="fas fa-plus"></i>Hợp đồng đã hủy</button>

        <label>
            <input class="search" type="text" name="search" [(ngModel)]="searchText" autocomplete="off" placeholder="Search..." />
            <div class="line-box">
                <div class="line"></div>
            </div>
        </label>

        <nb-accordion>
            <nb-accordion-item #find>
                <nb-accordion-item-body>
                    <h5 class="titlemng"><i class="fa fa-search"></i>&nbsp;Tìm kiếm khách hàng</h5>
                    <hr />
                    <div class="form-group row">
                        <div class="col-4 form-group mb-0">
                            <label for="idck">Tên khách hàng</label>
                            <input
                                [(ngModel)]="name"
                                status="primary"
                                type="text"
                                nbInput
                                fullWidth
                                shape="rectangle"
                                placeholder="Nhập họ & tên"
                            />
                        </div>
                        <div class="col-4 form-group mb-0">
                            <label for="idck">Mã giao dịch</label>
                            <input
                                [(ngModel)]="idCustom"
                                status="primary"
                                type="text"
                                nbInput
                                fullWidth
                                shape="rectangle"
                                placeholder="Mã giao dịch"
                            />
                        </div>
                        <div class="col-4 form-group mb-0">
                            <label for="idck">Mã tour</label>
                            <input
                                [(ngModel)]="codeTour"
                                status="primary"
                                type="text"
                                id="location"
                                nbInput
                                fullWidth
                                shape="rectangle"
                                placeholder="Mã tour"
                            />
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-4 form-group mb-0">
                            <label for="idck">Số điện thoại</label>
                            <input
                                [(ngModel)]="phone"
                                status="primary"
                                type="tel"
                                nbInput
                                fullWidth
                                shape="rectangle"
                                placeholder="Nhập số điện thoại"
                            />
                        </div>
                        <div class="col-4">
                            <label for="idck">Ngày đi</label>
                            <input [(ngModel)]="startDay" status="primary" type="date" nbInput fullWidth shape="rectangle" />
                        </div>
                        <div class="col-4">
                            <label for="idck">Ngày về</label>
                            <input [(ngModel)]="endDay" status="primary" type="date" nbInput fullWidth shape="rectangle" />
                        </div>
                    </div>
                    <button class="float-right m-2" size="large" nbButton status="info" (click)="filter()">Filter</button>
                </nb-accordion-item-body>
            </nb-accordion-item></nb-accordion
        >
    </div>
    <!-- phần con -->
    <nb-accordion multi>
        <nb-accordion-item *ngFor="let i of this.contract | filter: searchText; let c = index  | slice: (page-1) * pageSize : (page-1) * pageSize + pageSize" class="col-auto">
            <nb-accordion-item-header>
                <a class="mr-3" (click)="edit(i.id)"><i class="fas fa-pencil-alt"></i></a>
                <a class="mr-3" (click)="delete(i.id, i.idTour, i.tourQuantity, i.tourist, i.startDay, i.tourist, i.price)">
                    <i class="fas fa-trash"></i
                ></a>
                <div style=" font-size: 13px; padding-left: 5px; padding-right: 5px;">({{ i.id }})</div>
                {{ i.representative }}-
                <div class="text-info pr-2">{{ i.phone }}</div>

                /{{ i.tour }}

                <div class="price">
                    <a class="text-primary"> VNĐ: </a>
                    {{ i.price | number }}đ <a class="text-success  "> Số lượng: </a> {{ i.quantity }}
                </div>
            </nb-accordion-item-header>
            <nb-accordion-item-body>
                {{ i.nameTour }}
                <a class="pl-5 pr-3">Go: {{ i.startDay }} </a> End: {{ i.endDay }}
                <div class="row m-2 info">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th scope="col">#</th>
                                <th scope="col">Xóa</th>
                                <th scope="col">Họ & tên</th>
                                <th scope="col">Địa chỉ</th>
                                <th scope="col">Số điện thoại</th>
                                <th scope="col">Giới tính</th>
                                <th scope="col">Loại vé</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let n of i.tourist; let t = index">
                                <th scope="row">{{ t }}</th>
                                <th>
                                    <a (click)="deleteTicket(i.id, i.startDay, c, t, n, i.idTour, i.tourQuantity)">
                                        <i class="fas fa-trash"></i
                                    ></a>
                                </th>
                                <td>{{ n.name }}</td>
                                <td>{{ n.phonecustomer }}</td>
                                <td>{{ n.address }}</td>
                                <td>{{ n.gender }}</td>
                                <td>{{ n.type }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </nb-accordion-item-body>
        </nb-accordion-item>
    </nb-accordion>
    <ngb-pagination 
    [collectionSize]="this.contract.length / pageSize * 10" 
    [(page)]="page" 
    [maxSize]="3" 
    [rotate]="true" 
    [boundaryLinks]="true" 
    class="d-flex justify-content-end"
    >
  </ngb-pagination>
</nb-card>
